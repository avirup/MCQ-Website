{% extends "admin/base_admin.html" %}
{% block admin_content %}

<div class="admin-two-col">

  <!-- Left: All Subjects -->
  <section class="card">
    <h2 class="h-academic" style="margin-bottom:.5rem;">All Subjects</h2>

    {% if subjects %}
      <table class="table" style="margin-top:.25rem;">
        <thead>
          <tr>
            <th style="text-align:left;">Name</th>
            <th style="width:200px; text-align:right;">Actions</th>
          </tr>
        </thead>
        <tbody>
        {% for s in subjects %}
          <tr>
            <td>{{ s.name }}</td>
            <td>
              <div class="actions">
                <a class="btn btn-outline" href="{{ url_for('admin.subjects_edit', subject_id=s.id) }}">Edit</a>
                <form method="post"
                      action="{{ url_for('admin.subjects_delete', subject_id=s.id) }}"
                      onsubmit="return confirm('Delete this subject?');">
                  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                  <button class="btn btn-danger" type="submit">Delete</button>
                </form>
              </div>
            </td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p class="qmeta" style="margin:0;">No subjects yet.</p>
    {% endif %}
  </section>

  <!-- Right: Create / Edit -->
  <section class="card">
    {% if edit_mode %}
      <h2 class="h-academic" style="margin-bottom:.5rem;">Edit Subject</h2>
      <form method="post" action="{{ url_for('admin.subjects_update', subject_id=editing.id) }}">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <label for="name"><strong>Name</strong></label>
        <div class="form-row" style="margin-top:.25rem;">
          <input id="name" name="name" type="text" maxlength="100"
                 value="{{ form_data.name|default('', true) }}"
                 class="input" required>
          <button class="btn btn-primary" type="submit">Save</button>
          <a class="btn btn-outline" href="{{ url_for('admin.subjects') }}">Cancel</a>
        </div>
        {% if errors and errors.name %}
          <div style="color:#b00; margin-top:.35rem;">{{ errors.name }}</div>
        {% endif %}
      </form>
    {% else %}
      <h2 class="h-academic" style="margin-bottom:.5rem;">Create Subject</h2>
      <form method="post" action="{{ url_for('admin.subjects_create') }}">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <label for="name"><strong>Name</strong></label>
        <div class="form-row" style="margin-top:.25rem;">
          <input id="name" name="name" type="text" maxlength="100"
                 value="{{ form_data.name|default('', true) }}"
                 class="input" required>
          <button class="btn btn-primary" type="submit">Create</button>
        </div>
        {% if errors and errors.name %}
          <div style="color:#b00; margin-top:.35rem;">{{ errors.name }}</div>
        {% endif %}
      </form>
    {% endif %}
  </section>

</div>

{% endblock %}
