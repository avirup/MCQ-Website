{% extends "admin/base_admin.html" %}
{% block admin_content %}

<!-- KPI cards -->
<section>
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">

    <!-- Subjects -->
    <div class="bg-white border border-gray-200 rounded-xl shadow-sm p-4">
      <div class="text-sm font-medium text-gray-500">Subjects</div>
      <div class="text-3xl font-bold text-academic-navy mt-1">{{ subjects_count or 0 }}</div>
    </div>

    <!-- Questions -->
    <div class="bg-white border border-gray-200 rounded-xl shadow-sm p-4">
      <div class="text-sm font-medium text-gray-500">Questions</div>
      <div class="text-3xl font-bold text-academic-navy mt-1">{{ questions_count or 0 }}</div>
    </div>

    <!-- Images -->
    <div class="bg-white border border-gray-200 rounded-xl shadow-sm p-4">
      <div class="text-sm font-medium text-gray-500">Images</div>
      <div class="text-3xl font-bold text-academic-navy mt-1">{{ images_count or 0 }}</div>
    </div>

    <!-- Actions -->
    <div class="bg-white border border-gray-200 rounded-xl shadow-sm p-4 flex flex-col justify-between">
      <div>
        <div class="text-sm font-medium text-gray-500">Actions</div>
        <div class="text-xs text-gray-400">Quick admin shortcuts</div>
      </div>
      <div class="flex flex-wrap gap-2 mt-2">
        <a href="{{ url_for('admin.questions_new') }}"
           class="px-3 py-1.5 rounded-lg bg-academic-navy text-white text-sm hover:bg-academic-maroon transition">
          + Add Question
        </a>
        <a href="{{ url_for('admin.subjects') }}"
           class="px-3 py-1.5 rounded-lg border border-academic-navy text-academic-navy text-sm hover:bg-academic-navy hover:text-white transition">
          + Add Subject
        </a>
      </div>
    </div>

  </div>
</section>

<!-- Recent Questions -->
{% if recent_questions is defined %}
<section class="mt-6">
  <h2 class="text-lg font-semibold text-academic-navy border-b-4 border-academic-navy pb-1 mb-3">
    Recent Questions
  </h2>

  <div class="overflow-x-auto bg-white border border-gray-200 rounded-xl shadow-sm">
    <table class="min-w-full divide-y divide-gray-200 text-sm">
      <thead class="bg-gray-50">
        <tr>
          <th class="px-4 py-2 text-left font-semibold text-gray-700">ID</th>
          <th class="px-4 py-2 text-left font-semibold text-gray-700">Subject</th>
          <th class="px-4 py-2 text-left font-semibold text-gray-700">Snippet</th>
          <th class="px-4 py-2 text-left font-semibold text-gray-700">Difficulty</th>
          <th class="px-4 py-2 text-left font-semibold text-gray-700">Updated</th>
          <th class="px-4 py-2"></th>
        </tr>
      </thead>
      <tbody class="divide-y divide-gray-100">
        {% for q in recent_questions %}
          <tr class="hover:bg-gray-50">
            <td class="px-4 py-2">{{ q.id }}</td>
            <td class="px-4 py-2">{{ q.subject.name if q.subject else "—" }}</td>
            <td class="px-4 py-2 truncate max-w-xs">
              {{ (q.question_text|striptags)|truncate(80, True, "…") }}
            </td>
            <td class="px-4 py-2">
              <span class="px-2 py-0.5 rounded-md border border-gray-300 text-xs">
                {{ (q.difficulty.value if q.difficulty else "unrated")|capitalize }}
              </span>
            </td>
            <td class="px-4 py-2 text-gray-500">
              {{ q.updated_at.strftime("%Y-%m-%d") if q.updated_at else "" }}
            </td>
            <td class="px-4 py-2 text-right">
              <a href="{{ url_for('admin.questions_edit', qid=q.id) }}"
                 class="px-3 py-1.5 rounded-lg border border-academic-navy text-academic-navy text-sm hover:bg-academic-navy hover:text-white transition">
                Edit
              </a>
            </td>
          </tr>
        {% else %}
          <tr>
            <td colspan="6" class="px-4 py-3 text-gray-500 text-sm text-center">
              No recent questions.
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</section>
{% endif %}

{% endblock %}
